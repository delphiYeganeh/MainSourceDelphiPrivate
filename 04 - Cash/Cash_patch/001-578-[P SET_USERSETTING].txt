BEGIN TRANSACTION
GO
IF EXISTS ( SELECT 1
            FROM   sysobjects 
            WHERE  id = object_id(N'[dbo].[SET_USERSETTING]')
                   and OBJECTPROPERTY(id, N'IsProcedure') = 1 )
BEGIN
    DROP PROCEDURE [dbo].[SET_USERSETTING]
END
GO

CREATE  procedure [dbo].[SET_USERSETTING]
	@USERID  INT,
	@VARIABLENAME VARCHAR(50),
	@VALUE NVARCHAR(100)
AS
	IF NOT EXISTS(SELECT * FROM SETTING WHERE (USERID = @USERID) AND (VARIABLENAME = @VARIABLENAME))
		INSERT INTO SETTING(USERID,VARIABLENAME,VALUE) VALUES(@USERID,@VARIABLENAME,@VALUE)
	Else
		UPDATE SETTING 
		SET VALUE=@VALUE
		WHERE     (USERID = @USERID) AND (VARIABLENAME = @VARIABLENAME)
GO

COMMIT
GO