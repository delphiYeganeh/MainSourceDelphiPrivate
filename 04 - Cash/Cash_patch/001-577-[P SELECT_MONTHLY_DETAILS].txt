BEGIN TRANSACTION
GO
IF EXISTS ( SELECT 1
            FROM   sysobjects 
            WHERE  id = object_id(N'[dbo].[SELECT_MONTHLY_DETAILS]')
                   and OBJECTPROPERTY(id, N'IsProcedure') = 1 )
BEGIN
    DROP PROCEDURE [dbo].[SELECT_MONTHLY_DETAILS]
END
GO

CREATE  procedure [dbo].[SELECT_MONTHLY_DETAILS]
	@ACCOUNTID INT,
	@DATEFROM CHAR(10),
	@DATETO  CHAR(10),
	@PAID TINYINT
AS
Select	ACCOUNTTITLE, 
		ACCOUNTNO, 
		PAYMENT.DATE PAYDATE,
		0 REMAINAMOUNT, 
		FORCEPAYMENT.AMOUNT, 
		MATUREDATE, 
		ORDERNO
From FORCEPAYMENT 
	Inner Join  ACCOUNT ON FORCEPAYMENT.PARENTID = ACCOUNT.ACCOUNTID
	Left Join  PAYMENT ON FORCEPAYMENT.PAYMENTID = PAYMENT.PAYMENTID
Where  PARENTID = @ACCOUNTID 
	And FORCETYPEID = 2
	And (MATUREDATE BETWEEN @DATEFROM  AND @DATETO)
	And (PAID=@PAID OR @PAID=2) 
GO

COMMIT
GO